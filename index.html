<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OneTakeStudio â€” MSA Architecture</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>â–¶</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body,#root{width:100%;min-height:100vh;background:#080810;color:#e2e8f0;
    font-family:'Noto Sans KR','SF Pro Display',-apple-system,sans-serif}
  @keyframes flowPulse{0%,100%{opacity:.3;transform:scale(.8)}50%{opacity:1;transform:scale(1.3)}}
  @keyframes stepFadeIn{from{opacity:0;transform:translateX(-10px)}to{opacity:1;transform:translateX(0)}}
  ::-webkit-scrollbar{width:5px}::-webkit-scrollbar-thumb{background:#ffffff15;border-radius:3px}

  .cbox{border-radius:14px;position:relative;padding:10px}
  .cbox-label{position:absolute;top:-11px;left:16px;padding:0 8px;font-size:11px;font-weight:700;
    letter-spacing:1px;background:#080810}
  .cbox-icon{display:inline-flex;align-items:center;justify-content:center;border-radius:10px;
    width:32px;height:32px;font-size:16px;margin-right:6px;vertical-align:middle}

  .sc{border-radius:12px;padding:12px 14px;transition:all .35s ease;position:relative;overflow:hidden}
  .sc .tl{font-size:14px;font-weight:700;display:flex;justify-content:space-between;align-items:center}
  .sc .sb{font-size:11px;margin-top:3px}
  .sc .pt{font-size:10px;font-family:'JetBrains Mono',monospace;color:rgba(255,255,255,.22)}
  .sc.act{box-shadow:0 0 24px var(--shadow)}
  .sc.act::after{content:'';position:absolute;inset:0;border-radius:12px;
    background:radial-gradient(ellipse at center,var(--glow) 0%,transparent 70%);pointer-events:none}

  .dc{display:inline-block;padding:4px 10px;border-radius:7px;font-size:11px;font-weight:600;
    background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);margin:2px}

  .ad{display:flex;flex-direction:column;align-items:center;gap:0;padding:3px 0}
  .ad .ln{width:2px;height:14px;border-radius:1px}
  .ad .hd{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent}
  .ad .lb{font-size:9px;letter-spacing:.5px;margin-bottom:1px}

  .fb{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:12px;
    cursor:pointer;font-family:inherit;text-align:left;transition:all .25s ease;font-size:13px;width:100%}
  .fb .dot{margin-left:auto;width:8px;height:8px;border-radius:50%;animation:flowPulse 1.5s ease-in-out infinite}

  .cb{padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,.07);
    background:#0d0d16;color:#94a3b8;cursor:pointer;font-size:13px;font-family:inherit;font-weight:500}

  .sd{border-radius:50%;transition:all .3s ease;flex-shrink:0}
  .sr{width:2px;flex:1;min-height:12px;transition:all .3s ease;border-radius:1px}
  .bg{display:inline-block;padding:2px 8px;border-radius:5px;font-size:10px;font-weight:600;margin-bottom:3px}

  .ci-n{display:flex;flex-direction:column;align-items:center;gap:4px;min-width:72px}
  .ci-i{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;
    font-size:22px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.03)}
  .ci-l{font-size:10px;font-weight:600;color:#e2e8f0}
  .ci-s{font-size:9px;color:#475569}
  .ci-a{color:#8B5CF6;font-size:16px;opacity:.5;align-self:center}

  .lr{display:flex;align-items:center;gap:10px;padding:3px 0}
  .ll{width:24px;height:3px;border-radius:2px;flex-shrink:0}
  .lb2{width:20px;height:12px;border-radius:3px;flex-shrink:0;border-width:2px;border-style:solid}
</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script type="text/babel">
const {useState,useEffect}=React;

const FLOWS=[
  {id:"live-stream",label:"ë¼ì´ë¸Œ ìŠ¤íŠ¸ë¦¬ë°",color:"#EC4899",icon:"ğŸ“º",steps:[
    {node:"user",text:"ìŠ¤íŠ¸ë¦¬ë¨¸ ë°©ì†¡ ì‹œì‘"},{node:"client",text:"WebRTC ë¯¸ë””ì–´ ìº¡ì²˜"},
    {node:"traefik",text:"Traefik Ingress ë¼ìš°íŒ…"},{node:"media",text:"Media Service: WebRTC/RTMP ì²˜ë¦¬"},
    {node:"redis",text:"Redis Streams: ë°©ì†¡ ì‹œì‘ ì´ë²¤íŠ¸"},{node:"core",text:"Core Service: ìŠ¤íŠœë””ì˜¤ ìƒíƒœ ì—…ë°ì´íŠ¸"},
    {node:"platform",text:"YouTube RTMP ë¼ì´ë¸Œ ì†¡ì¶œ"},
  ]},
  {id:"ai-shorts",label:"AI ì‡¼ì¸  ìƒì„±",color:"#F97316",icon:"âœ‚ï¸",steps:[
    {node:"media",text:"Media Service: ë…¹í™” ì™„ë£Œ ì´ë²¤íŠ¸"},{node:"redis",text:"Redis Streams: Coreì— ë…¹í™” ì™„ë£Œ ì „ë‹¬"},
    {node:"core",text:"Core Service: AI ë¶„ì„ ìš”ì²­"},{node:"ai",text:"AI Service: í•˜ì´ë¼ì´íŠ¸ êµ¬ê°„ ì¶”ì¶œ"},
    {node:"ai",text:"AI Service: STT + ìë§‰ ìƒì„±"},{node:"core",text:"Core â†’ Media: ì‡¼ì¸  ì €ì¥ ìš”ì²­"},
    {node:"media",text:"Media: EC2 ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥"},{node:"client",text:"í´ë¼ì´ì–¸íŠ¸: ì‡¼ì¸  ì¹´ë“œ í‘œì‹œ"},
  ]},
  {id:"realtime-chat",label:"ì‹¤ì‹œê°„ ì±„íŒ…",color:"#0EA5E9",icon:"ğŸ’¬",steps:[
    {node:"user",text:"ì‹œì²­ì ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡"},{node:"client",text:"Socket.io ì›¹ì†Œì¼“ ì—°ê²°"},
    {node:"traefik",text:"Traefik â†’ Media ë¼ìš°íŒ…"},{node:"media",text:"Chat Domain: ë©”ì‹œì§€ ë¸Œë¡œë“œìºìŠ¤íŠ¸"},
    {node:"media-db",text:"MySQL: ì±„íŒ… ë¡œê·¸ ì €ì¥"},{node:"redis",text:"Redis Streams: ì±„íŒ… ë¹ˆë„ ì´ë²¤íŠ¸"},
    {node:"core",text:"Core â†’ AI: ë°˜ì‘ ë¶„ì„ ìš”ì²­"},{node:"ai",text:"AI: í•˜ì´ë¼ì´íŠ¸ ë§ˆì»¤ ìƒì„±"},
    {node:"client",text:"ì‹¤ì‹œê°„ ì±„íŒ… UI ì—…ë°ì´íŠ¸"},
  ]},
  {id:"auth-flow",label:"íšŒì›ê°€ì… / ë¡œê·¸ì¸",color:"#10B981",icon:"ğŸ”",steps:[
    {node:"user",text:"ì•„ì´ë”” / ë¹„ë°€ë²ˆí˜¸ / ë‹‰ë„¤ì„ ì…ë ¥"},{node:"client",text:"POST /api/auth/register"},
    {node:"traefik",text:"Traefik IngressRoute â†’ Core"},{node:"core",text:"Core: ì¤‘ë³µ ì²´í¬ + bcrypt í•´ì‹±"},
    {node:"core-db",text:"MySQL: User ë ˆì½”ë“œ ì €ì¥"},{node:"client",text:"JWT í† í° ë°œê¸‰ â†’ ë¡œê·¸ì¸ ì™„ë£Œ"},
  ]},
  {id:"recording",label:"ë…¹í™” & ë§ˆì»¤",color:"#8B5CF6",icon:"âºï¸",steps:[
    {node:"client",text:"ë…¹í™” ì‹œì‘ / ë§ˆì»¤ ì„¤ì •"},{node:"traefik",text:"Traefik â†’ Media Service"},
    {node:"media",text:"Recording Domain: ë…¹í™” ì„¸ì…˜ ìƒì„±"},{node:"media-db",text:"MySQL: ë©”íƒ€ë°ì´í„° ì €ì¥"},
    {node:"media",text:"EC2 ë¡œì»¬: ì˜ìƒ ì €ì¥"},{node:"redis",text:"Redis Streams: ë…¹í™” ì™„ë£Œ â†’ Core"},
    {node:"core",text:"Core â†’ AI: ì‡¼ì¸  ìƒì„± íŠ¸ë¦¬ê±°"},{node:"client",text:"Libraryì—ì„œ ë…¹í™”ë³¸ ì¡°íšŒ"},
  ]},
];

const NM={
  user:{c:"#94a3b8",l:"ğŸ‘¤ User"},client:{c:"#0EA5E9",l:"âš›ï¸ Client"},
  traefik:{c:"#2196F3",l:"ğŸ”€ Traefik"},core:{c:"#10B981",l:"ğŸŸ¢ Core"},
  "core-db":{c:"#10B981",l:"ğŸ¬ MySQL"},media:{c:"#EC4899",l:"ğŸ©· Media"},
  "media-db":{c:"#EC4899",l:"ğŸ¬ MySQL"},ai:{c:"#F97316",l:"ğŸ§  AI"},
  redis:{c:"#DC382D",l:"ğŸ”´ Redis"},platform:{c:"#6366f1",l:"â–¶ YouTube"},
};

function hx(h){const v=parseInt(h.slice(1),16);return`${(v>>16)&255},${(v>>8)&255},${v&255}`}

function SC({id,icon,title,sub,port,domains,activeId,flowNodes,children}){
  const m=NM[id]||NM.user;const rgb=hx(m.c);
  const act=activeId===id;const inf=flowNodes.has(id);
  const bg=act?.18:inf?.10:.04;const br=act?.55:inf?.28:.10;
  return(
    <div className={"sc"+(act?" act":"")} style={{
      background:`rgba(${rgb},${bg})`,border:`1.5px solid rgba(${rgb},${br})`,
      "--shadow":`rgba(${rgb},.2)`,"--glow":`rgba(${rgb},.06)`,
    }}>
      <div className="tl">
        <span style={{color:act?m.c:inf?"#e2e8f0":"#94a3b8"}}>{icon} {title}</span>
        {port&&<span className="pt">:{port}</span>}
      </div>
      {sub&&<div className="sb" style={{color:inf?"#94a3b8":"#475569"}}>{sub}</div>}
      {domains&&<div style={{marginTop:5,display:"flex",flexWrap:"wrap",gap:0}}>
        {domains.map(d=><span key={d} className="dc">{d}</span>)}
      </div>}
      {children}
    </div>
  );
}

function AD({color,label}){
  return(
    <div className="ad">
      {label&&<span className="lb" style={{color:color+"70"}}>{label}</span>}
      <div className="ln" style={{background:color+"50"}}/>
      <div className="hd" style={{borderTopColor:color+"80",borderTopWidth:5,borderTopStyle:"solid"}}/>
    </div>
  );
}

function App(){
  const[af,setAf]=useState("live-stream");
  const[as2,setAs]=useState(0);
  const[pl,setPl]=useState(true);
  const cf=FLOWS.find(f=>f.id===af);
  const an=cf.steps[as2]?.node;
  const fn=new Set(cf.steps.map(s=>s.node));

  useEffect(()=>{
    if(!pl)return;
    const t=setInterval(()=>setAs(p=>(p+1)%cf.steps.length),1800);
    return()=>clearInterval(t);
  },[pl,af,cf.steps.length]);

  useEffect(()=>setAs(0),[af]);

  const cp={activeId:an,flowNodes:fn};

  return(
    <div style={{minHeight:"100vh",width:"100%",background:"#080810",padding:"20px 20px"}}>

      {/* Header */}
      <div style={{display:"flex",alignItems:"center",gap:14,marginBottom:14}}>
        <div style={{width:48,height:48,borderRadius:14,background:"linear-gradient(135deg,#6366f1,#ec4899)",
          display:"flex",alignItems:"center",justifyContent:"center",fontSize:22,fontWeight:900,color:"#fff",
          boxShadow:"0 0 20px rgba(99,102,241,.3)"}}>â–¶</div>
        <div>
          <h1 style={{fontSize:28,fontWeight:900,letterSpacing:-1,
            background:"linear-gradient(135deg,#6366f1,#ec4899,#f59e0b)",
            WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}>OneTakeStudio</h1>
          <p style={{fontSize:11,color:"#475569",letterSpacing:3,fontWeight:300}}>MSA SYSTEM ARCHITECTURE</p>
        </div>
        <div style={{marginLeft:"auto",display:"flex",flexWrap:"wrap",gap:4}}>
          {[
            {l:"Spring Boot 3.5.9",c:"#10B981"},{l:"Java 21",c:"#F59E0B"},{l:"React/Next.js",c:"#0EA5E9"},
            {l:"FastAPI",c:"#F97316"},{l:"k3s+Traefik",c:"#326CE5"},{l:"Redis Streams",c:"#DC382D"},{l:"6ì¸ íŒ€",c:"#8B5CF6"},
          ].map(t=>(
            <span key={t.l} style={{padding:"3px 8px",borderRadius:5,fontSize:10,fontWeight:600,
              background:t.c+"10",color:t.c,border:`1px solid ${t.c}20`}}>{t.l}</span>
          ))}
        </div>
      </div>

      <div style={{display:"flex",gap:14}}>

        {/* â•â•â•â•â•â• LEFT â•â•â•â•â•â• */}
        <div style={{flex:"1 1 64%",minWidth:0,display:"flex",flexDirection:"column",gap:8}}>

          {/* VPC */}
          <div className="cbox" style={{border:"1.5px dashed rgba(139,92,246,.15)",padding:10}}>
            <div className="cbox-label" style={{color:"rgba(139,92,246,.4)"}}>VPC 10.0.0.0/16</div>

            {/* Public Subnet */}
            <div className="cbox" style={{border:"1px dashed rgba(14,165,233,.12)",padding:8,marginBottom:6}}>
              <div className="cbox-label" style={{color:"rgba(14,165,233,.3)",fontSize:10}}>PUBLIC SUBNET</div>
              <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8}}>
                <SC id="user" icon="ğŸ‘¤" title="Users" sub="ë¸Œë¼ìš°ì € Â· ëª¨ë°”ì¼" {...cp}/>
                <SC id="client" icon="âš›ï¸" title="Next.js Client" sub="WebRTC Â· Socket.io Â· Zustand" {...cp}/>
                <SC id="platform" icon="â–¶" title="YouTube" sub="RTMP ë¼ì´ë¸Œ ì†¡ì¶œ" {...cp}/>
              </div>
            </div>

            <div style={{display:"flex",justifyContent:"center",padding:"1px 0"}}>
              <AD color="#0EA5E9" label="HTTPS / WSS â†’ Traefik Ingress"/>
            </div>

            {/* Private Subnet */}
            <div className="cbox" style={{border:"1px dashed rgba(16,185,129,.08)",padding:8}}>
              <div className="cbox-label" style={{color:"rgba(16,185,129,.25)",fontSize:10}}>PRIVATE SUBNET</div>

              {/* EC2 */}
              <div className="cbox" style={{border:"2px dashed rgba(255,153,0,.3)",padding:8,marginBottom:6}}>
                <div className="cbox-label" style={{color:"#FF9900",fontSize:11}}>
                  <span className="cbox-icon" style={{background:"rgba(255,153,0,.12)",border:"1px solid rgba(255,153,0,.25)"}}>ğŸ–¥ï¸</span>
                  EC2 Instance <span style={{fontWeight:400,color:"rgba(255,153,0,.5)",fontSize:10}}>t3.xlarge</span>
                </div>

                {/* k3s */}
                <div className="cbox" style={{border:"2px solid rgba(50,108,229,.25)",padding:8}}>
                  <div className="cbox-label" style={{color:"#326CE5",fontSize:11}}>
                    <span className="cbox-icon" style={{background:"rgba(50,108,229,.12)",border:"1px solid rgba(50,108,229,.25)"}}>â˜¸ï¸</span>
                    k3s Cluster
                  </div>

                  <SC id="traefik" icon="ğŸ”€" title="Traefik Ingress Controller"
                    sub="k3s ë‚´ì¥ Â· SSL/TLS ì¢…ë‹¨ Â· IngressRoute ì„œë¹„ìŠ¤ ë¼ìš°íŒ…" {...cp}/>

                  <div style={{display:"flex",justifyContent:"space-around",padding:"1px 0"}}>
                    <AD color="#10B981" label="/api/core â†’"/>
                    <AD color="#EC4899" label="/api/media â†’"/>
                  </div>

                  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:6}}>
                    <SC id="core" icon="ğŸŸ¢" title="Core Service" port="8080"
                      sub="Spring Boot 3.5.9 Â· Java 21"
                      domains={["ğŸ” Auth","ğŸ‘¤ User","ğŸ¬ Studio","ğŸ“Š Workspace","ğŸ“ Storage"]} {...cp}>
                      <div style={{marginTop:5,display:"flex",gap:4,flexWrap:"wrap"}}>
                        <span style={{padding:"3px 8px",borderRadius:6,fontSize:10,fontWeight:600,
                          background:"rgba(0,117,143,.1)",color:"#0097B2",border:"1px solid rgba(0,117,143,.2)"}}>ğŸ¬ MySQL (Core)</span>
                        <span style={{padding:"3px 8px",borderRadius:6,fontSize:10,fontWeight:600,
                          background:"rgba(255,153,0,.08)",color:"#FF9900",border:"1px solid rgba(255,153,0,.15)"}}>ğŸ’¾ EC2 Storage</span>
                      </div>
                    </SC>
                    <SC id="media" icon="ğŸ©·" title="Media Service" port="8082"
                      sub="Spring Boot 3.5.9 Â· Java 21"
                      domains={["ğŸ“º Streaming","âºï¸ Recording","ğŸ’¬ Chat"]} {...cp}>
                      <div style={{marginTop:5,display:"flex",gap:4,flexWrap:"wrap"}}>
                        <span style={{padding:"3px 8px",borderRadius:6,fontSize:10,fontWeight:600,
                          background:"rgba(0,117,143,.1)",color:"#0097B2",border:"1px solid rgba(0,117,143,.2)"}}>ğŸ¬ MySQL (Media)</span>
                        <span style={{padding:"3px 8px",borderRadius:6,fontSize:10,fontWeight:600,
                          background:"rgba(255,153,0,.08)",color:"#FF9900",border:"1px solid rgba(255,153,0,.15)"}}>ğŸ’¾ ì˜ìƒÂ·ë…¹í™”Â·ì‡¼ì¸ </span>
                      </div>
                    </SC>
                  </div>

                  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8}}>
                    <SC id="redis" icon="ğŸ”´" title="Redis Streams" sub="Core â†” Media ë¹„ë™ê¸° ì´ë²¤íŠ¸ Â· ë°©ì†¡/ë…¹í™” ì™„ë£Œ" {...cp}/>
                    <div className="sc" style={{background:"rgba(255,255,255,.02)",border:"1px solid rgba(255,255,255,.06)",padding:"8px 12px"}}>
                      <div style={{fontSize:10,color:"#475569",letterSpacing:1,fontWeight:600,marginBottom:4}}>MONITORING</div>
                      <div style={{display:"flex",gap:4,flexWrap:"wrap"}}>
                        <span className="dc" style={{background:"rgba(230,82,44,.08)",color:"#E6522C",borderColor:"rgba(230,82,44,.15)"}}>ğŸ“ˆ Prometheus</span>
                        <span className="dc" style={{background:"rgba(244,104,0,.08)",color:"#F46800",borderColor:"rgba(244,104,0,.15)"}}>ğŸ“‰ Grafana</span>
                        <span className="dc" style={{background:"rgba(36,150,237,.08)",color:"#2496ED",borderColor:"rgba(36,150,237,.15)"}}>ğŸ³ Docker</span>
                      </div>
                    </div>
                  </div>

                </div>{/* k3s */}
              </div>{/* EC2 */}

              <div style={{display:"flex",alignItems:"center",gap:6,padding:"3px 0"}}>
                <div style={{flex:1,height:1,background:"linear-gradient(90deg,transparent,#F97316 30%,#F97316 70%,transparent)",opacity:.3}}/>
                <span style={{fontSize:10,color:"#F97316",opacity:.6,letterSpacing:1,fontWeight:600}}>REST API â†’ AI ë¶„ì„ ìš”ì²­ (ì ì„  = ì™¸ë¶€ í†µì‹ )</span>
                <div style={{flex:1,height:1,background:"linear-gradient(90deg,transparent,#F97316 30%,#F97316 70%,transparent)",opacity:.3}}/>
              </div>

              <SC id="ai" icon="ğŸ§ " title="AI Service (ë³„ë„ GPU ì„œë²„)" port="8000"
                sub="FastAPI Â· Python Â· GPU Inference"
                domains={["âœ‚ï¸ Auto-Clip","ğŸ™ï¸ STT Whisper","ğŸŒ ë‹¤êµ­ì–´ ìë§‰","ğŸ§  ì˜ìƒ ë¶„ì„"]} {...cp}>
                <div className="sb" style={{marginTop:3,color:"#64748b"}}>í•˜ì´ë¼ì´íŠ¸ ì¶”ì¶œ â†’ ì‡¼ì¸  ìë™ ìƒì„± Â· ê°ì •/ë°˜ì‘ ë¶„ì„</div>
              </SC>
            </div>{/* Private */}
          </div>{/* VPC */}

          {/* CI/CD */}
          <div style={{background:"rgba(139,92,246,.02)",border:"1px solid rgba(139,92,246,.1)",
            borderRadius:14,padding:"12px 16px"}}>
            <div style={{fontSize:11,color:"rgba(139,92,246,.4)",letterSpacing:2,fontWeight:700,marginBottom:8,textAlign:"center"}}>
              CI / CD PIPELINE
            </div>
            <div style={{display:"flex",alignItems:"center",justifyContent:"center",gap:8}}>
              <div className="ci-n"><div className="ci-i">ğŸ™</div><span className="ci-l">GitHub</span><span className="ci-s">Source Code</span></div>
              <span className="ci-a">â†’</span>
              <div className="ci-n"><div className="ci-i" style={{borderColor:"rgba(32,136,255,.15)"}}>âš¡</div><span className="ci-l">Actions</span><span className="ci-s">Build Â· Test</span></div>
              <span className="ci-a">â†’</span>
              <div className="ci-n"><div className="ci-i" style={{borderColor:"rgba(36,150,237,.15)"}}>ğŸ³</div><span className="ci-l">Docker</span><span className="ci-s">Registry</span></div>
              <span className="ci-a">â†’</span>
              <div className="ci-n"><div className="ci-i" style={{borderColor:"rgba(50,108,229,.15)"}}>ğŸš€</div><span className="ci-l">k3s Deploy</span><span className="ci-s">Rolling Update</span></div>
            </div>
          </div>

        </div>

        {/* â•â•â•â•â•â• RIGHT â•â•â•â•â•â• */}
        <div style={{flex:"1 1 36%",minWidth:260,display:"flex",flexDirection:"column",gap:8}}>

          <div style={{display:"flex",flexDirection:"column",gap:5}}>
            {FLOWS.map(flow=>{
              const act=af===flow.id;
              return(
                <button key={flow.id} className="fb"
                  onClick={()=>{setAf(flow.id);setPl(true)}}
                  style={{
                    border:`1px solid ${act?flow.color+"50":"rgba(255,255,255,.04)"}`,
                    background:act?flow.color+"14":"#0d0d16",
                    color:act?flow.color:"#64748b",fontWeight:act?700:500,
                  }}>
                  <span style={{fontSize:17}}>{flow.icon}</span>
                  <span>{flow.label}</span>
                  {act&&<div className="dot" style={{background:flow.color,boxShadow:`0 0 8px ${flow.color}`}}/>}
                </button>
              );
            })}
          </div>

          <div style={{display:"flex",gap:6}}>
            <button className="cb" style={{flex:1}} onClick={()=>setPl(!pl)}>
              {pl?"â¸ ì¼ì‹œì •ì§€":"â–¶ ì¬ìƒ"}
            </button>
            <button className="cb" onClick={()=>setAs(p=>(p+1)%cf.steps.length)}>ë‹¤ìŒ â†’</button>
          </div>

          <div style={{background:"#0d0d16",borderRadius:14,border:"1px solid rgba(255,255,255,.04)",
            padding:"12px 12px",flex:1,overflowY:"auto",maxHeight:320}}>
            <div style={{fontSize:10,color:"#475569",marginBottom:8,letterSpacing:2,fontWeight:600}}>
              {cf.icon} {cf.label.toUpperCase()} FLOW
            </div>
            <div style={{display:"flex",flexDirection:"column"}}>
              {cf.steps.map((step,i)=>{
                const act=as2===i;const past=i<as2;
                const m=NM[step.node]||NM.user;
                return(
                  <div key={i} onClick={()=>setAs(i)} style={{display:"flex",gap:10,cursor:"pointer"}}>
                    <div style={{display:"flex",flexDirection:"column",alignItems:"center",width:18,flexShrink:0}}>
                      <div className="sd" style={{
                        width:act?12:8,height:act?12:8,
                        background:act?cf.color:past?cf.color+"60":"#1e293b",
                        border:`2px solid ${act?cf.color:past?cf.color+"40":"#334155"}`,
                        boxShadow:act?`0 0 10px ${cf.color}60`:"none",
                      }}/>
                      {i<cf.steps.length-1&&<div className="sr" style={{background:past?cf.color+"30":"#1e293b"}}/>}
                    </div>
                    <div style={{paddingBottom:10,animation:act?"stepFadeIn .3s ease":"none"}}>
                      <div className="bg" style={{background:m.c+"18",color:m.c}}>{m.l}</div>
                      <div style={{fontSize:12,color:act?"#f1f5f9":past?"#94a3b8":"#475569",
                        fontWeight:act?600:400,lineHeight:1.4}}>{step.text}</div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>

          {/* Legend */}
          <div style={{background:"rgba(255,255,255,.015)",border:"1px solid rgba(255,255,255,.04)",
            borderRadius:14,padding:"12px 14px"}}>
            <div style={{fontSize:11,color:"#64748b",letterSpacing:2,fontWeight:700,marginBottom:8}}>ARCHITECTURE LEGEND</div>
            <div className="lr"><div className="lb2" style={{borderColor:"#FF9900",borderStyle:"dashed",background:"none"}}/><span style={{fontSize:11,color:"#94a3b8"}}>EC2 ì¸ìŠ¤í„´ìŠ¤ ê²½ê³„</span></div>
            <div className="lr"><div className="lb2" style={{borderColor:"#326CE5",borderStyle:"solid",background:"none"}}/><span style={{fontSize:11,color:"#94a3b8"}}>k3s í´ëŸ¬ìŠ¤í„° ê²½ê³„</span></div>
            <div className="lr"><div className="lb2" style={{borderColor:"rgba(139,92,246,.3)",borderStyle:"dashed",background:"none"}}/><span style={{fontSize:11,color:"#94a3b8"}}>VPC ë„¤íŠ¸ì›Œí¬ ê²½ê³„</span></div>
            <div style={{height:1,background:"rgba(255,255,255,.05)",margin:"6px 0"}}/>
            {[
              {c:"#10B981",l:"Core Service ë¼ìš°íŒ…"},{c:"#EC4899",l:"Media Service ë¼ìš°íŒ…"},
              {c:"#DC382D",l:"Redis Streams ì´ë²¤íŠ¸"},{c:"#F97316",l:"REST (Core â†’ AI)",d:true},
              {c:"#6366f1",l:"RTMP (â†’ YouTube)"},{c:"#8B5CF6",l:"CI/CD Pipeline"},
            ].map(it=>(
              <div key={it.l} className="lr">
                <div className="ll" style={it.d
                  ?{background:`repeating-linear-gradient(90deg,${it.c} 0 5px,transparent 5px 8px)`}
                  :{background:it.c}}/>
                <span style={{fontSize:11,color:"#94a3b8"}}>{it.l}</span>
              </div>
            ))}
            <div style={{height:1,background:"rgba(255,255,255,.05)",margin:"6px 0"}}/>
            <div style={{fontSize:10,color:"#475569",fontWeight:600,letterSpacing:1,marginBottom:3}}>DATA FLOW</div>
            {["â‘  User â†’ Next.js â†’ Traefik â†’ Service",
              "â‘¡ Core â†” Redis â†” Media (ë¹„ë™ê¸°)",
              "â‘¢ Core â†’ AI (REST ë¶„ì„ ìš”ì²­)",
              "â‘£ Media â†’ YouTube (RTMP ì†¡ì¶œ)",
            ].map(t=><div key={t} style={{fontSize:10,color:"#475569",lineHeight:1.5}}>{t}</div>)}
          </div>

        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
